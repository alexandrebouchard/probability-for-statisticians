\documentclass{article}
\usepackage{etoolbox}
\csdef{input@path}{%
 {sty/}% 
 {figures/}%
}%


\title{Stat 547C: Exercise 1 solutions}
\author{Alexandre Bouchard-C\^ot\'e}

\input{macros/typesetting-macros}
\input{macros/basic-math-macros}
\input{macros/notation}

\begin{document}

\maketitle

\begin{enumerate}
  \item Let $X$ be a random variable with a uniform distribution on $[0, 1)$. Draw a possible graph of $X$, a density for $X$, and the \CDF\ of $X$.
  \item Convince yourself that their intersection $\events \cap \eventsâ€²$ is also a $\sigma$-algebra.
  \item Show that the composition $g(X)$ of two random variables is a random variable.
  \item Simulate an exponential random variable from a uniform distribution on [0, 1).
  \item If $X_1 \sim F$ (a notation that means that $\P(X_1 \le x) = F(x)$), and $X_1 \ge 0$, find the \CDF\ of $X_2 \defeq X_1^2$.
  \item Show that if $Y$ and $Y'$ are simple functions then $\E[Y+Y']=\E[Y] + \E[Y']$ (linearity of expectations of simple random variables).
\end{enumerate}


\section*{Solutions}

\begin{enumerate}
  \item The three pictures should be as follows:
  \begin{enumerate}
    \item Graph of $X$: The $x$-axis should be a bounded segment labelled $\Omega$. The $y$-axis should be the full real line. There are several choices for the function. For example the line $y = x$ or $y = 1 - x$ on the interval $[0, 1)$ are acceptable. Other choices are possible.
    \item CDF: The $x$-axis should be the full real line. The $y$ axis should be the interval $[0, 1]$. The function should be zero in $(-\infty, 0]$, then affine in $[0, 1]$, then one in $[1, +\infty)$.
    \item Density: the $x$ axis should be the full real line. The $y$ axis should be the positive real line. The function should be the indicator on the set $[0, 1)$.
  \end{enumerate}
  \item We need to check the three conditions given in the definition of \sigmaalg:
  \begin{enumerate}
    \item Since $\events$ is a \sigmaalg, $\Omega \in \events$ and since $\events'$ is a \sigmaalg, $\Omega \in \events'$, therefore $\Omega \in \events \cap \events'$.
    \item We need to show that if $A_1, A_2, \dots$ are all in $\events \cap \events'$, then $\cap A_i \in \events \cap \events'$. By the definition of intersection, we have that $A_1, A_2, \dots$ are all in $\events$. Since $\events$ is a \sigmaalg, it follows that $\cap A_i \in \events$. By the same reasoning, $\cap A_i \in \events'$. Therefore, $\cap A_i \in \events \cap \events'$.
    \item We need to show that if $A \in \events \cap \events'$, then $A^\complement \in \events \cap \events'$. By the definition of intersection, we have that $A \in \events$. Since $\events$ is a \sigmaalg, it follows that $A^\complement \in \events$. By the same reasoning, $A^\complement \in \events'$. Therefore, $A^\complement \in \events \cap \events'$.
  \end{enumerate}
  \item We have that $X: \Omega \to \states$ and $g : \states \to \states'$ are random variables. Let us denote by $\events_\Omega, \events_{\states}$ and $\events_{\states'}$ the \sigmaalg\ on $\Omega$, $\states$ and $\states'$ respectively. Let $A \in \events_{\states'}$. We have to show that $(g \circ X)^{-1}(A) \in \events_\Omega$. First, note that $(g \circ X)^{-1}(A) = X^{-1}(g^{-1}(A))$. Since $g$ is a random variable, $g^{-1}(A) \in \events_\states$. Next, since $X$ is a random variables, $g^{-1}(A) \in \events_\states$ implies that $X^{-1}(g^{-1}(A)) \in \events_\Omega$.
   \item As in Section~1.18 of the lecture notes, we pick $X(\omega) \defeq \sup\{x : F(x) < \omega\}$ (note that in this special case where $\Omega = [0, 1)$,  writing ``$F(x) < \omega$'' is well defined---for general $\Omega$ this would not).
This construction has some nice properties:
\begin{enumerate}
  \item \label{point:inv-cdf-monotone} $X$ is monotone increasing (this follows directly from the definition),
  \item \label{point:inv-cdf-incl-one} $X\circ F(x) \le x$ (draw a picture of a \CDF\ having flat regions to convince yourself),
  \item \label{point:inv-cdf-incl-two}$F\circ X(\omega) \ge \omega$ (draw a picture of a \CDF\ having discontinuities to convince yourself).
\end{enumerate}
We first use properties \ref{point:inv-cdf-incl-one} and \ref{point:inv-cdf-incl-two} to prove the following set equality:
\[ (X \le x) = \{\omega \in \Omega : \omega \le F(x) \}.\]
We show that the LHS includes the RHS and vice versa:
\begin{itemize} 
  \item $\{\omega \in \Omega : \omega \le F(x) \} \subseteq (X \le x)$:
\begin{eqnarray*}
\omega \le F(x) &\Longrightarrow& X(\omega)  \le X\circ F(x)\;\text{ (from \ref{point:inv-cdf-monotone})} \\
&\Longrightarrow& X(\omega) \le x\;\text{(from \ref{point:inv-cdf-incl-one}).}
\end{eqnarray*}
  \item $(X \le x) \subseteq \{\omega \in \Omega : \omega \le F(x) \}$:
\begin{eqnarray*}
X(\omega) \le x &\Longrightarrow& F\circ X(\omega)  \le F(x)\;\text{ (monotonicity of CDFs)} \\
&\Longrightarrow& \omega \le F(x)\;\text{(from \ref{point:inv-cdf-incl-two}).} 
\end{eqnarray*}
\end{itemize}
Finally, it follows that:
\begin{eqnarray*}
\text{CDF of }X &\defeq& \P(X \le x) \\ 
&=& \P\{\omega \in \Omega : \omega \le F(x) \} \\ 
&=& F(x) \;\text{ (by the definition of uniform probability).}  
\end{eqnarray*}
Here in this special case: $X(\omega) = - \lambda^{-1} \log(1 - \omega)$. 
\item We have:
\begin{eqnarray*}
F_{X_2}(x) &\defeq& \P(X_2 \le x) \\
&=& \P(X_1^2 \le x) \\
&=& \P(-\sqrt{x} \le X_1 \le \sqrt{x}) \\
&=& \P(X_1 \le \sqrt{x}) \;\text{(Non-negativity assumption)} \\
&=& F(\sqrt{x}).
\end{eqnarray*}

  \item First, we show that $Y + Y'$ is a simple function (this will allow us to use the easy definition of expectation given in Section~2.4). Write $Y = \sum_{i=1}^N a_i \1_{A_i}$, and $Y' = \sum_{j=1}^M b_j \1{B_j}$ and assume without loss of generality that $A_i$ forms a partition, and that $B_j$ forms another partition.\footnote{Otherwise, add one more block $A_{N+1} = \cup_{i=1}^N A_i$ with $a_{N+1} = 0$. Same for $B_j$.} Consider the sets $\{C_{i,j} = A_i \cap B_j : 1\le i \le N, 1\le j \le M\}$. Note that the $C_{i,j}$ are clearly disjoint, and that on $C_{i,j}$, $(Y + Y')$ is equal to $a_i + b_j$. Therefore:
\begin{eqnarray*}
\E[Y + Y'] &=& \sum_{i,j} (a_i + b_j) \1_{C_{i,j}} \\
&=& \sum_{i,j} a_i \1_{C_{i,j}} + \sum_{i,j} b_j \1_{C_{i,j}} \\
&=& \sum_{i} a_i \sum_j \1_{C_{i,j}} + \sum_{j} b_j \sum_i \1_{C_{i,j}} \\
&=& \sum_{i} a_i  \1_{\cup_j C_{i,j}} + \sum_{j} b_j  \1_{\cup_i C_{i,j}} \;\text{(since the }C_{i,j}\text{ are disjoint)} \\
&=& \sum_{i} a_i  \1_{A_i} + \sum_{j} b_j  \1_{B_j} \;\text{(since }\{A_{i}\}\text{ is a partitions, similarly for }\{B_{j}\} \text{ )} \\
&=& \E[Y] + \E[Y'].
\end{eqnarray*}

\end{enumerate}

\end{document}